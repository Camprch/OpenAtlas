<!-- Menu de filtres flottant -->
<div id="filter-menu" style="display:none; position:fixed; top:60px; left:80px; transform:none; background:#23272e; color:#eee; border:1px solid #444; border-radius:12px; box-shadow:0 4px 24px #0008; z-index:9999; min-width:260px; padding:18px 20px;">
    <button id="filter-menu-close" style="background:#444; color:#eee; border:none; border-radius:6px; padding:6px 16px; cursor:pointer; position:absolute; top:8px; right:12px;">Ã—</button>
    <div id="filter-menu-options" style="margin-top:18px;"></div>
</div>
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MAP</title>

    <!-- Favicon emoji ğŸ›°ï¸ -->
    <link rel="icon" type="image/svg+xml"
          href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dominant-baseline='central' font-size='52'%3EğŸ›°ï¸%3C/text%3E%3C/svg%3E">

    <link rel="stylesheet" href="/static/css/dashboard.css" />

    <!-- Leaflet -->
    <link
        rel="stylesheet"
        href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
        crossorigin=""
    >
    <script
        src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
        crossorigin=""
    ></script>
</head>

<body>


<header style="display: flex; align-items: center; gap: 8px; justify-content: space-between;">
    <div style="display: flex; align-items: center; gap: 16px;">
        <span class="logo-icon" style="display: flex; align-items: center; justify-content: center; width: 36px; height: 36px; background: linear-gradient(135deg, #22c55e 60%, #2563eb 100%); border-radius: 50%; box-shadow: 0 2px 8px #0005; font-size: 1.5rem; margin-right: 5px; border: 2px solid #23272e;">ğŸŒ</span>
        <span style="font-size: 1.35rem; font-weight: 700; letter-spacing: 1.2px; color: #eee; font-family: 'Segoe UI', Arial, sans-serif; text-shadow: 0 2px 6px #0003;">MAP</span>
        <div id="filter-container-global" style="display: flex; align-items: center; gap: 4px;">
            <button id="filter-btn-global" style="padding:6px 14px; background:#1a1f24; border: 1px solid #444; color:#eee; border-radius:999px; font-size:13px; outline:none; cursor:pointer; transition:background 0.15s, box-shadow 0.15s, transform 0.1s; text-decoration:none; font-weight:normal; display:inline-flex; align-items:center; gap:7px; font-family: Arial, sans-serif; text-transform:none; letter-spacing:normal;">Filters <span style='font-size:1.2em;'>ğŸ”¬</span></button>
            <input id="search-input" type="text" placeholder="ğŸ” Search..." style="padding:6px 12px; background:#23272e; border:1px solid #444; color:#eee; border-radius:999px; font-size:13px; outline:none; font-family: Arial, sans-serif; width:160px; transition:box-shadow 0.15s; margin-left:4px;" />
        </div>
    </div>
        <div style="display: flex; align-items: center; gap: 8px; margin-right:10px;">
            <div id="pipeline-bar-btn" style="padding:6px 14px; background:#1a1f24; border: 1px solid #444; color:#eee; border-radius:999px; font-size:13px; outline:none; cursor:pointer; transition:background 0.15s, box-shadow 0.15s, transform 0.1s; text-decoration:none; font-weight:normal; display:inline-flex; align-items:center; gap:7px; font-family: Arial, sans-serif; text-transform:none; letter-spacing:normal; position:relative; overflow:hidden; height:auto; min-width:0; width:auto; box-sizing:border-box;">
                <div id="pipeline-bar-fill" style="position:absolute; left:0; top:0; height:100%; width:0; background:#22c55e; border-radius:999px; z-index:1; transition:width 0.3s;"></div>
                <span id="pipeline-bar-label" style="position:relative; z-index:2; width:100%; text-align:center; pointer-events:none;">Refresh ğŸ”ƒ</span>
                <span id="pipeline-percent" style="display:none; position:relative; z-index:2; margin-left:8px; font-size:13px; color:#22c55e; font-family:monospace;">0%</span>
            </div>
            <button id="pipeline-logs-toggle" title="Afficher les logs pipeline" style="padding:6px 10px; background:#1a1f24; border: 1px solid #444; color:#eee; border-radius:999px; font-size:18px; outline:none; cursor:pointer; display:inline-flex; align-items:center; justify-content:center; height:32px; width:32px; margin-left:2px;">ğŸ§¬</button>
            <div id="pipeline-logs-panel" style="display:none; position:absolute; top:60px; right:30px; width:480px; max-width:90vw; max-height:60vh; background:#181c20; color:#e0e0e0; border:1px solid #444; border-radius:10px; box-shadow:0 4px 24px #000a; z-index:9999; padding:14px 18px 10px 18px; font-family:monospace; font-size:13px; overflow-y:auto; white-space:pre-wrap;"><div style="display:flex;justify-content:space-between;align-items:center;"><b>Logs pipeline</b><button id="pipeline-logs-close" style="background:none;border:none;color:#aaa;font-size:18px;cursor:pointer;">âœ–</button></div><div id="pipeline-logs-content" style="margin-top:8px;max-height:45vh;overflow-y:auto;"></div></div>
            <a href="/env-editor" title="Settings" style="padding:6px 14px; background:#1a1f24; border: 1px solid #444; color:#eee; border-radius:999px; font-size:13px; outline:none; cursor:pointer; transition:background 0.15s, box-shadow 0.15s; text-decoration:none; font-weight:normal; display:inline-flex; align-items:center; gap:7px; font-family: Arial, sans-serif; text-transform:none; letter-spacing:normal;">Settings <span style='font-size:1.2em;'>âš™ï¸</span></a>
        </div>
</header>

<div id="dashboard-alert"></div>

<div id="map"></div>

<!-- Panneau latÃ©ral -->
<div id="sidepanel">
    <button id="close-panel">âœ–</button>
    <div id="sidepanel-header-row">
        <h2 id="panel-country-name"><span id="panel-country-text"></span></h2>
    </div>
    <div id="sidepanel-content">
        <div id="sidepanel-events-header" style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
            <h3 style="margin: 0;">Events ğŸ“°</h3>
            <div id="filter-container-panel">
                <button id="filter-btn-panel" style="padding:6px 14px; background:#1a1f24; border: 1px solid #444; color:#eee; border-radius:999px; font-size:13px; outline:none; cursor:pointer; transition:background 0.15s, box-shadow 0.15s, transform 0.1s; text-decoration:none; font-weight:normal; display:inline-flex; align-items:center; gap:7px; font-family: Arial, sans-serif; text-transform:none; letter-spacing:normal;">Filter <span style='font-size:1.2em;'>ğŸ”</span></button>
            </div>
        </div>
        <div id="events"></div>
    </div>
</div>
<div id="sidepanel-backdrop"></div>

<script type="module" src="/static/js/modules/main.js"></script>
<script type="module">import '/static/js/modules/search.js';</script>
</body>
</html>
